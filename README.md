# Программа для управления позиционером Standa 8cmc5 (python, ximc)

Писалось под драйвер 8smc5-usb-b9-2(хотя подойдет под аналоги). [Вот](https://www.standa.lt/products/catalog/motorised_positioners?item=654) эти контроллеры на сайте производителя. *Очень рекомендую изучить*, есть вся документация, ссылки на драйверы, программу управления и т.д.

Версия ximc **2.10.5.** Уже давно есть  [новая либа](https://doc.xisupport.com/en/8smc5-usb/8SMCn-USB/Programming/Programming_guide.html), но пока до нее руки не дошли + ОБЯЗАТЕЛЬНО нужно перепрошить на новую версию сами контроллеры! Некоторые вещи сделаны крайне арахично, в новой либе все проще. Однако суть осталась одна и та же - по факту у них dll для С/С++ и через ctypes кастуют методы и структуры. Не более. 

# TODO

Версия пока крайне сырая, и с учетом того, что "нативнее" переписать на Си - не уверен, что дойдут руки довести до совершенства:)

- [x] GUI на Tkinter

- [x] Коннект, хоминг, класс для работы с осью(Axis) - интегрированно в GUI

- [ ] Получение координат при движении

- [ ] Отправка в требуемые координаты

- [ ] Установка скорости и ускорений в GUI

- [ ] Запоминание базовой координаты

- [ ] Реализация циклического движения в GUI

## Требования

- Python 3+

- Windows 10/11 (на Linux будет ок, поддержка есть, но по ТЗ задача была реализовать в Windows...)

GUI реализован на Tkinter, поэтому в Windows никакой дополнительной настройки не требуется. 

## Как работает

Наши драйверы работают в режиме serial - определяются в винде просто как COM-порт. Может быть иначе, но в таком режиме даже драйверы ставить не нужно(тестировалось на Win10). В папке win64 и win32 лежат требуемые dll, кроме них ничего не нужно. Запускать нужно ИЛИ gui.py (эта версия, внезапно, с GUI) ИЛИ standa.py(это CLI-версия). На самом деле, это обман, никакого CLI там нет, но можно ручками ввести требуемые операции:) 

**ВАЖНО!** Запускать скрипт нужно строго из той папки, где расположен скрипт изначально. Он цепляет pyximc.py (биндинг от производителя) и DLL. 

**Важно x2**: прежде чем запускать скрипт, убедитесь, что драйверам ПОДАНО ПИТАНИЕ(лампочки моргают), usb подключен и система видит 2 COM-порта(или 1, если контроллер одноканальный)


